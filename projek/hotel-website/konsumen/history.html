<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>History Pemesanan - UNIKU Resort</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    :root{
      --yellow:#FBC02D;
      --dark:#111;
      --light:#fff;
      --green:#28a745;
      --orange:#ffc107;
    }

    body{
      font-family:"Inter",Arial,sans-serif;
      background:linear-gradient(135deg, var(--yellow) 5%, #fff 95%);
      min-height:100vh;
      margin:0;
    }

    .container{
      max-width:900px;
    }

    h3{
      text-align:center;
      font-weight:700;
      margin-bottom:20px;
      color:var(--dark);
    }

    .booking-card{
      background:var(--light);
      border-radius:16px;
      padding:20px;
      box-shadow:0 8px 25px rgba(0,0,0,.1);
      margin-bottom:15px;
      transition:all .3s ease;
    }

    .booking-card:hover{
      transform:translateY(-3px);
      box-shadow:0 12px 25px rgba(0,0,0,.15);
    }

    .badge-lunas{
      background:var(--green);
      color:#fff;
      font-weight:600;
      padding:.35em .65em;
      border-radius:.5rem;
    }

    .badge-belum{
      background:var(--orange);
      color:#111;
      font-weight:600;
      padding:.35em .65em;
      border-radius:.5rem;
    }

    .btn-sm{
      border-radius:.5rem;
      font-weight:600;
    }

    .btn-success{
      background:var(--green);
      border:0;
      transition:all .3s ease;
    }

    .btn-success:hover{
      background:#218838;
      transform:scale(1.05);
    }

    .btn-danger{
      background:#dc3545;
      border:0;
      transition:all .3s ease;
    }

    .btn-danger:hover{
      background:#c82333;
      transform:scale(1.05);
    }

    a.btn-link{
      font-weight:600;
      color:var(--dark);
      text-decoration:none;
    }

    a.btn-link:hover{
      text-decoration:underline;
    }

    @media (max-width:480px){
      h3{font-size:1.3rem;}
      .btn-sm{font-size:.75rem;}
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <a href="dashboard.html" class="btn btn-link">&larr; Kembali</a>
    <h3>History Pemesanan</h3>

    <div id="historyList"></div>
  </div>

  <script>
    if(localStorage.getItem('consumerLoggedIn')!=='true') location.href='login.html';

    const user = JSON.parse(localStorage.getItem('consumer')) || {username:'User1'};
    const historyList = document.getElementById('historyList');

    // Data booking palsu
    const sampleBookings = [
      {id:1, nama:user.username, room:'Deluxe Room', checkin:'2026-01-01', checkout:'2026-01-03', paymentMethod:'Transfer', status:'Lunas'},
      {id:2, nama:user.username, room:'Suite Room', checkin:'2026-01-05', checkout:'2026-01-07', paymentMethod:'Bayar di Tempat', status:'Belum Lunas'},
      {id:3, nama:user.username, room:'Standard Room', checkin:'2026-01-10', checkout:'2026-01-12', paymentMethod:'Transfer', status:'Lunas'}
    ];

    // Simpan ke localStorage (overwrite untuk demo)
    localStorage.setItem('bookings', JSON.stringify(sampleBookings));

    function render(){
      historyList.innerHTML = '';
      const bookings = JSON.parse(localStorage.getItem('bookings')||'[]');
      bookings.forEach(b => {
        const div = document.createElement('div');
        div.className = 'booking-card';
        div.innerHTML = `
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5>${b.room}</h5>
            <span class="${b.status==='Lunas'?'badge-lunas':'badge-belum'}">${b.status}</span>
          </div>
          <p><strong>Nama:</strong> ${b.nama}</p>
          <p><strong>Periode:</strong> ${b.checkin} â†’ ${b.checkout}</p>
          <p><strong>Metode Pembayaran:</strong> ${b.paymentMethod}</p>
          <div>
            ${b.status!=='Lunas'?`<button class="btn btn-sm btn-success me-1" onclick="pay(${b.id})">Bayar (sim)</button>`:''}
            <button class="btn btn-sm btn-danger" onclick="del(${b.id})">Hapus</button>
          </div>
        `;
        historyList.appendChild(div);
      });
    }

    function pay(id){
      const bookings = JSON.parse(localStorage.getItem('bookings')||'[]');
      const idx = bookings.findIndex(x=>x.id==id);
      if(idx!==-1){
        bookings[idx].status='Lunas';
        localStorage.setItem('bookings', JSON.stringify(bookings));
        render();
      }
    }

    function del(id){
      if(!confirm('Hapus booking ini?')) return;
      let bookings = JSON.parse(localStorage.getItem('bookings')||'[]');
      bookings = bookings.filter(x=>x.id!=id);
      localStorage.setItem('bookings', JSON.stringify(bookings));
      render();
    }

    render();
  </script>
</body>
</html>
